(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const s of l.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function i(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(n){if(n.ep)return;n.ep=!0;const l=i(n);fetch(n.href,l)}})();function T(t,e){return Array.from({length:e+1},(n,l)=>l).sort(()=>Math.random()-.5).slice(0,t)}function y(t){return t.length===0?-1:t[Math.floor(Math.random()*t.length)]}function h(t,e){if(t.length===0||e.length===0||t.length!==e.length)return-1;const i=e.reduce((s,L)=>s+L,0),r=e.map(s=>s/i),n=Math.random();let l=0;for(let s=0;s<r.length;s++)if(l+=r[s],n<=l)return t[s]}const f=16,c=parseInt(Math.sqrt(f)),g=[2,4],p=[.75,.25],u=[],o=[],E=document.getElementById("score");function M(){const t=document.getElementById("grid");t.style.gridTemplateRows=`repeat(${c}, 1fr)`,t.style.gridTemplateColumns=`repeat(${c}, 1fr)`;for(let e=0;e<f;e++){const i=document.createElement("div");i.setAttribute("class","cell"),t.appendChild(i),u.push(i),o.push(0)}}function m(t){const e=document.createElement("div");return e.classList.add("tile"),e.classList.add(`tile-${t}`),e.innerText=t,e}function b(){T(2,f-1).forEach(e=>{const i=h(g,p),r=m(i);r.classList.add("tile-shrink"),u[e].append(r),o[e]=i,r.classList.remove("tile-shrink")})}function O(){return o.reduce((t,e,i)=>(e===0&&t.push(i),t),[])}function a(){const t=y(O()),e=h(g,p),i=m(e);i.classList.add("tile-shrink"),u[t].append(i),o[t]=e,setTimeout(()=>{i.classList.remove("tile-shrink")},100)}function v(){let t=0;o.forEach(e=>{t+=e}),E.innerHTML=t}function _(t,e){const i=t%c;for(let r=1;r<=i;r++){const n=t-1;if(o[n]!==0)return o[n]===e?n:t;t=n}return t}function A(t,e){const i=Math.floor(t/c);for(let r=1;r<=i;r++){const n=t-c;if(o[n]!==0)return o[n]===e?n:t;t=n}return t}function C(t,e){const i=(Math.floor(t/c)+1)*4-t-1;for(let r=1;r<=i;r++){const n=t+1;if(o[n]!==0)return o[n]===e?n:t;t=n}return t}function N(t,e){const i=Math.floor(f-t/c);for(let r=1;r<=i;r++){const n=t+c;if(o[n]!==0)return o[n]===e?n:t;t=n}return t}function d(t,e){if(t===e)return;const i=o[t],r=o[e];let n=i;r===i&&(n=parseInt(i*2)),o[t]=0,o[e]=n,u[t].innerHTML="",u[e].innerHTML="",u[e].appendChild(m(n))}function R(){let t=0;for(let e=0;e<f;e++){if(o[e]===0)continue;const i=_(e,o[e]);i!==e&&(d(e,i),t++)}t>0&&a()}function S(){let t=0;for(let e=0;e<f;e++){if(o[e]===0)continue;const i=A(e,o[e]);i!==e&&(d(e,i),t++)}t>0&&a()}function I(){let t=0;for(let e=f-1;e>=0;e--){if(o[e]===0)continue;const i=C(e,o[e]);i!==e&&(d(e,i),t++)}t>0&&a()}function P(){let t=0;for(let e=f-1;e>=0;e--){if(o[e]===0)continue;const i=N(e,o[e]);i!==e&&(d(e,i),t++)}t>0&&a()}function U(){document.addEventListener("keydown",t=>{const e=t.keyCode;e===37?R():e===38?S():e===39?I():e===40&&P(),v()})}function W(){M(),b(),U(),v()}W();
